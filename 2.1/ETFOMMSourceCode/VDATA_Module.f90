! Copyright © 2014
! New Global Systems for Intelligent Transportation Management Corp.
  
! This file is part of ETFOMM.
!
! This program is free software: you can redistribute it and/or modify
! it under the terms of the GNU Affero General Public License as
! published by the Free Software Foundation, either version 3 of the
! License, or (at your option) any later version.
!
! This program is distributed in the hope that it will be useful,
! but WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
! GNU Affero General Public License for more details.
!
! You should have received a copy of the GNU Affero General Public License
! along with this program.  If not, see <http://www.gnu.org/licenses/>.

  MODULE VDATA
       
    REAL :: ACCEL_TABLE(0:110, 7) = (/                             &

! PERFORMANCE INDEX 1

    8.0  , 8.0  , 9.0  ,10.0  ,10.0  ,10.0  ,10.0  ,10.0  ,10.0,    &
    9.0  , 9.0  , 9.0  , 9.0  , 9.0  , 8.0  , 8.0  , 8.0  , 7.0,    &
    7.0  , 6.0  , 6.0  , 6.0  , 6.0  , 6.0  , 5.0  , 5.0  , 5.0,    &
    5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0,    &
    5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0,    &
    5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 4.0,    &
    4.0  , 4.0  , 4.0  , 4.0  , 3.0  , 3.0  , 4.0  , 4.0  , 4.0,    &
    4.0  , 4.0  , 4.0  , 3.0  , 3.0  , 3.0  , 3.0  , 3.0  , 3.0,    &
    3.0  , 3.0  , 3.0  , 3.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0,    &
    2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0,    &
    2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 1.0,    &
    1.0  , 1.0  , 1.0  , 1.0  , 1.0  , 1.0  , 1.0  , 1.0  , 1.0,    &
    1.0  , 1.0  , 1.0  ,                                            &

! PERFORMANCE INDEX 2

    6.0  ,10.0  ,12.0  ,12.0  ,12.0  ,12.0  ,                       &
  12.0  ,12.0  ,12.0  ,12.0  ,12.0  ,12.0  ,12.0  ,12.0  ,12.0,    &
  12.0  ,11.0  ,11.0  ,11.0  ,10.0  ,10.0  ,10.0  , 9.0  , 9.0,    &
    9.0  , 9.0  , 9.0  , 8.0  , 8.0  , 8.0  , 8.0  , 8.0  , 8.0,    &
    7.0  , 7.0  , 7.0  , 7.0  , 7.0  , 7.0  , 7.0  , 7.0  , 7.0,    &
    7.0  , 7.0  , 7.0  , 7.0  , 6.0  , 6.0  , 6.0  , 6.0  , 6.0,    &
    5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 5.0  , 4.0  , 4.0,    &
    4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0,    &
    4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0,    &
    4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0  , 4.0,    &
    4.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0,    &
    2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0,    &
    2.0  , 2.0  , 2.0  , 2.0  , 2.0  , 2.0  ,                       &

! PERFORMANCE INDEX 3

    4.686, 4.686, 4.685,                                            &
    4.684, 4.683, 4.682, 5.028, 5.151, 5.234, 5.298, 5.346, 5.385,  &
    5.397, 5.406, 5.385, 5.347, 5.308, 5.234, 5.160, 5.049, 4.937,  &
    4.236, 3.535, 3.546, 3.557, 3.554, 3.551, 3.536, 3.521, 3.498,  &
    3.474, 3.443, 3.412, 3.376, 3.340, 3.300, 3.260, 3.218, 3.175,  &
    3.130, 3.085, 3.039, 2.992, 2.945, 2.897, 2.850, 2.802, 2.754,  &
    2.706, 2.658, 2.610, 2.562, 2.514, 2.467, 2.420, 2.373, 2.326,  &
    2.280, 2.233, 2.187, 2.140, 2.095, 2.049, 2.004, 1.959, 1.915,  &
    1.870, 1.826, 1.782, 1.739, 1.695, 1.652, 1.609, 1.566, 1.523,  &
    1.481, 1.439, 1.397, 1.355, 1.313, 1.271, 1.230, 1.189, 1.148,  &
    1.106, 1.066, 1.025, 0.985, 0.944, 0.904, 0.863, 0.823, 0.782,  &
    0.742, 0.702, 0.662, 0.621, 0.581, 0.541, 0.501, 0.461, 0.421,  &
    0.381, 0.341, 0.301, 0.261, 0.221, 0.181, 0.141, 0.101, 0.061,  &

! PERFORMANCE INDEX 4

    2.814, 2.814, 2.813, 2.812, 2.813, 2.808, 2.773, 2.714, 2.664,  &
    2.551, 2.424, 1.683, 1.778, 1.855, 1.932, 1.987, 2.041, 2.077,  &
    2.112, 2.131, 2.150, 2.156, 2.162, 2.158, 2.153, 2.141, 2.128,  &
    2.110, 2.091, 2.068, 2.044, 2.018, 1.991, 1.962, 1.933, 1.903,  &
    1.872, 1.841, 1.809, 1.777, 1.744, 1.712, 1.679, 1.647, 1.614,  &
    1.582, 1.549, 1.517, 1.484, 1.453, 1.421, 1.390, 1.358, 1.327,  &
    1.296, 1.266, 1.253, 1.205, 1.174, 1.145, 1.115, 1.086, 1.056,  &
    1.027, 0.998, 0.970, 0.941, 0.913, 0.885, 0.857, 0.829, 0.802,  &
    0.774, 0.747, 0.720, 0.693, 0.666, 0.639, 0.612, 0.586, 0.559,  &
    0.533, 0.506, 0.480, 0.453, 0.427, 0.401, 0.375, 0.349, 0.323,  &
    0.297, 0.271, 0.245, 0.219, 0.193, 0.167, 0.141, 0.116, 0.090,  &
    0.064, 0.038, 0.012,-0.015,-0.043,-0.070,-0.098,-0.125,-0.153,  &
  -0.181,-0.208,-0.235,                                            &

! PERFORMANCE INDEX 5

    2.761, 2.761, 2.759, 2.759, 2.760, 2.755,                       &
    2.721, 2.661, 2.611, 2.498, 2.372, 1.608, 1.674, 1.720, 1.765,  &
    1.788, 1.811, 1.817, 1.823, 1.816, 1.808, 1.792, 1.776, 1.754,  &
    1.731, 1.705, 1.678, 1.649, 1.619, 1.589, 1.558, 1.527, 1.495,  &
    1.464, 1.432, 1.401, 1.370, 1.340, 1.309, 1.279, 1.249, 1.220,  &
    1.190, 1.162, 1.134, 1.106, 1.078, 1.052, 1.025, 0.999, 0.973,  &
    0.948, 0.922, 0.898, 0.873, 0.869, 0.865, 0.822, 0.779, 0.757,  &
    0.734, 0.712, 0.689, 0.668, 0.646, 0.625, 0.604, 0.583, 0.562,  &
    0.542, 0.521, 0.501, 0.481, 0.461, 0.441, 0.422, 0.402, 0.383,  &
    0.363, 0.344, 0.325, 0.306, 0.287, 0.269, 0.250, 0.232, 0.213,  &
    0.195, 0.176, 0.158, 0.139, 0.121, 0.102, 0.084, 0.066, 0.048,  &
    0.029, 0.011,-0.007,-0.026,-0.045,-0.064,-0.083,-0.102,-0.121,  &
  -0.140,-0.159,-0.178,-0.196,-0.215,-0.234,                       &

! PERFORMANCE INDEX 6

    2.452, 2.452, 2.451,                                            &
    2.451, 2.451, 2.445, 2.412, 2.355, 2.308, 2.200, 2.136, 1.435,  &
    1.468, 1.483, 1.499, 1.496, 1.493, 1.477, 1.462, 1.439, 1.416,  &
    1.389, 1.361, 1.331, 1.301, 1.271, 1.240, 1.209, 1.178, 1.148,  &
    1.117, 1.088, 1.059, 1.030, 1.002, 0.975, 0.947, 0.921, 0.895,  &
    0.870, 0.845, 0.822, 0.798, 0.775, 0.752, 0.730, 0.708, 0.687,  &
    0.666, 0.646, 0.626, 0.607, 0.587, 0.568, 0.550, 0.532, 0.513,  &
    0.496, 0.478, 0.461, 0.444, 0.428, 0.411, 0.395, 0.379, 0.363,  &
    0.347, 0.332, 0.316, 0.301, 0.286, 0.271, 0.256, 0.242, 0.227,  &
    0.212, 0.198, 0.184, 0.170, 0.155, 0.141, 0.127, 0.114, 0.100,  &
    0.086, 0.072, 0.058, 0.045, 0.031, 0.018, 0.004,-0.010,-0.024,  &
  -0.038,-0.052,-0.066,-0.079,-0.093,-0.107,-0.121,-0.135,-0.148,  &
  -0.162,-0.176,-0.189,-0.203,-0.217,-0.230,-0.244,-0.258,-0.271,  &

! PERFORMANCE INDEX 7

    7.465, 7.465, 7.464, 7.268, 7.314, 6.829, 6.446, 6.122, 5.849,  &
    5.636, 5.326, 5.039, 4.820, 4.613, 4.348, 4.114, 3.905, 3.724,  &
    3.526, 3.340, 3.174, 3.054, 2.933, 2.891, 2.848, 2.807, 2.765,  &
    2.739, 2.713, 2.689, 2.665, 2.632, 2.599, 2.563, 2.527, 2.486,  &
    2.445, 2.408, 2.371, 2.332, 2.293, 2.252, 2.211, 2.155, 2.099,  &
    2.029, 1.958, 1.824, 1.690, 1.670, 1.650, 1.626, 1.602, 1.578,  &
    1.553, 1.531, 1.508, 1.482, 1.455, 1.428, 1.400, 1.377, 1.354,  &
    1.317, 1.280, 1.240, 1.200, 1.161, 1.122, 1.035, 0.947, 0.926,  &
    0.904, 0.884, 0.864, 0.845, 0.826, 0.805, 0.789, 0.765, 0.745,  &
    0.724, 0.702, 0.681, 0.659, 0.639, 0.618, 0.592, 0.565, 0.535,  &
    0.505, 0.476, 0.446, 0.417, 0.387, 0.358, 0.328,-0.328,-0.328,  &
  -0.330,-0.333,-0.335,-0.338,-0.336,-0.342,-0.344,-0.346,-0.348,  &
  -0.351,-0.353,-0.355 /)                                           
        
  REAL :: GRADE_TABLE(0:110, 7) = (/                               &

! PERFORMANCE INDEX 1

    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305,                                            &

! PERFORMANCE INDEX 2

    0.305, 0.305, 0.305, 0.305, 0.305, 0.305,                       &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305, 0.305,  &
    0.305, 0.305, 0.305, 0.305, 0.305, 0.305,                       &

! PERFORMANCE INDEX 3

    0.211, 0.211, 0.211,                                            &
    0.211, 0.211, 0.211, 0.210, 0.210, 0.210, 0.211, 0.211, 0.211,  &
    0.211, 0.211, 0.210, 0.210, 0.210, 0.210, 0.210, 0.210, 0.210,  &
    0.211, 0.212, 0.212, 0.212, 0.213, 0.214, 0.214, 0.215, 0.217,  &
    0.218, 0.220, 0.221, 0.223, 0.224, 0.226, 0.228, 0.227, 0.226,  &
    0.230, 0.234, 0.234, 0.233, 0.237, 0.241, 0.243, 0.244, 0.246,  &
    0.247, 0.249, 0.250, 0.252, 0.253, 0.254, 0.255, 0.256, 0.257,  &
    0.259, 0.260, 0.261, 0.262, 0.263, 0.264, 0.265, 0.266, 0.267,  &
    0.268, 0.269, 0.269, 0.270, 0.271, 0.271, 0.272, 0.273, 0.274,  &
    0.274, 0.275, 0.275, 0.276, 0.277, 0.278, 0.278, 0.279, 0.279,  &
    0.280, 0.280, 0.281, 0.281, 0.282, 0.283, 0.284, 0.285, 0.287,  &
    0.289, 0.291, 0.293, 0.295, 0.297, 0.299, 0.301, 0.302, 0.303,  &
    0.305, 0.306, 0.308, 0.309, 0.311, 0.312, 0.313, 0.314, 0.315,  &

! PERFORMANCE INDEX 4      

    0.164, 0.164, 0.164, 0.164, 0.164, 0.164, 0.163, 0.161, 0.160,  &
    0.156, 0.153, 0.202, 0.199, 0.198, 0.196, 0.195, 0.195, 0.195,  &
    0.194, 0.194, 0.195, 0.196, 0.198, 0.200, 0.202, 0.204, 0.206,  &
    0.208, 0.210, 0.212, 0.215, 0.217, 0.220, 0.222, 0.225, 0.227,  &
    0.229, 0.231, 0.234, 0.236, 0.238, 0.240, 0.242, 0.241, 0.245,  &
    0.247, 0.249, 0.250, 0.252, 0.253, 0.255, 0.256, 0.258, 0.259,  &
    0.260, 0.261, 0.263, 0.264, 0.265, 0.266, 0.267, 0.268, 0.269,  &
    0.270, 0.271, 0.272, 0.273, 0.273, 0.274, 0.276, 0.278, 0.279,  &
    0.281, 0.283, 0.285, 0.286, 0.288, 0.290, 0.292, 0.293, 0.295,  &
    0.296, 0.298, 0.299, 0.300, 0.301, 0.302, 0.303, 0.304, 0.305,  &
    0.306, 0.307, 0.308, 0.308, 0.309, 0.309, 0.310, 0.310, 0.311,  &
    0.311, 0.312, 0.312, 0.313, 0.313, 0.313, 0.313, 0.312, 0.312,  &
    0.312, 0.312, 0.311,                                            &

! PERFORMANCE INDEX 5

    0.177, 0.177, 0.177, 0.177, 0.177, 0.177,                       &
    0.176, 0.175, 0.174, 0.172, 0.169, 0.202, 0.200, 0.199, 0.197,  &
    0.198, 0.198, 0.199, 0.200, 0.202, 0.205, 0.207, 0.210, 0.213,  &
    0.216, 0.219, 0.221, 0.224, 0.227, 0.230, 0.233, 0.235, 0.238,  &
    0.240, 0.243, 0.245, 0.247, 0.249, 0.251, 0.253, 0.255, 0.257,  &
    0.259, 0.260, 0.262, 0.263, 0.265, 0.266, 0.268, 0.269, 0.270,  &
    0.271, 0.272, 0.273, 0.274, 0.276, 0.278, 0.279, 0.281, 0.283,  &
    0.285, 0.287, 0.289, 0.290, 0.291, 0.292, 0.293, 0.293, 0.294,  &
    0.296, 0.298, 0.299, 0.301, 0.301, 0.302, 0.303, 0.304, 0.304,  &
    0.305, 0.305, 0.306, 0.306, 0.307, 0.307, 0.308, 0.308, 0.309,  &
    0.309, 0.310, 0.310, 0.311, 0.311, 0.311, 0.311, 0.312, 0.312,  &
    0.312, 0.312, 0.312, 0.312, 0.312, 0.312, 0.312, 0.312, 0.311,  &
    0.311, 0.311, 0.311, 0.311, 0.311, 0.310,                       &

! PERFORMANCE INDEX 6

    0.184, 0.184, 0.184,                                            &
    0.184, 0.184, 0.184, 0.184, 0.183, 0.182, 0.181, 0.181, 0.197,  &
    0.196, 0.197, 0.198, 0.200, 0.202, 0.205, 0.208, 0.212, 0.216,  &
    0.219, 0.233, 0.237, 0.240, 0.243, 0.237, 0.240, 0.243, 0.246,  &
    0.248, 0.251, 0.253, 0.256, 0.258, 0.260, 0.262, 0.264, 0.266,  &
    0.267, 0.269, 0.271, 0.273, 0.276, 0.279, 0.282, 0.285, 0.287,  &
    0.289, 0.291, 0.292, 0.294, 0.295, 0.296, 0.298, 0.299, 0.300,  &
    0.301, 0.301, 0.302, 0.302, 0.303, 0.304, 0.304, 0.305, 0.306,  &
    0.306, 0.306, 0.303, 0.303, 0.304, 0.308, 0.308, 0.309, 0.309,  &
    0.309, 0.309, 0.310, 0.310, 0.310, 0.310, 0.311, 0.311, 0.311,  &
    0.311, 0.311, 0.311, 0.311, 0.311, 0.312, 0.312, 0.312, 0.312,  &
    0.312, 0.311, 0.311, 0.311, 0.311, 0.311, 0.311, 0.311, 0.311,  &
    0.310, 0.310, 0.310, 0.310, 0.310, 0.310, 0.310, 0.310, 0.310,  &

! PERFORMANCE INDEX 7

    0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274,  &
    0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274,  &
    0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274,  &
    0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274,  &
    0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274, 0.274,  &
    0.274, 0.274, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291,  &
    0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291,  &
    0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.291, 0.298, 0.298,  &
    0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298,  &
    0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298,  &
    0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298,  &
    0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298, 0.298,  &
    0.298, 0.298, 0.298/)                                            
      
  REAL :: DECEL_TABLE(0:110, 7) = (/                               &

! PERFORMANCE INDEX 1

  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0,-15.0,-15.0,                                                  &

! PERFORMANCE INDEX 2

  -15.0,-15.0,-15.0,-15.0,-15.0,-15.0,                                   &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0,-15.0,-15.0,-15.0,-15.0,-15.0,                                   &
                                                                       
! PERFORMANCE INDEX 3

  -15.0,-15.0,-15.0,                                                  &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
                                                                       
! PERFORMANCE INDEX 4

  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0,-15.0,-15.0,                                                  &

! PERFORMANCE INDEX 5

  -15.0,-15.0,-15.0,-15.0,-15.0,-15.0,                                   &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0,-15.0,-15.0,-15.0,-15.0,-15.0,                                   &

! PERFORMANCE INDEX 6

  -15.0,-15.0,-15.0,                                                  &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &

! PERFORMANCE INDEX 7

  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0, -15.0,            &
  -15.0,-15.0,-15.0 /)                                                

  CONTAINS
      
  ! ==================================================================================================
    REAL FUNCTION MAX_ACCEL(NTYPE, RSPD, IGRADE)
    IMPLICIT NONE
    INTEGER, INTENT(IN) :: NTYPE
    REAL, INTENT(IN) :: RSPD, IGRADE
    INTEGER :: ITYPE, ISPD
    REAL :: RX
  ! ----------------------------------------------------------------------
    if(ntype .eq. 12) then
      max_accel = 5
      return
    endif
    ISPD = MIN(110, INT(RSPD))
    ITYPE = NTYPE
    IF(ITYPE .EQ. 8 .OR. ITYPE .EQ. 9) ITYPE = ITYPE - 7
    IF(ITYPE .EQ. 10 .OR. ITYPE .EQ. 11) ITYPE = 1
    MAX_ACCEL = ACCEL_TABLE(ISPD, ITYPE)
 
  ! --- Adjust the max acceleration for grade if necessary.
 
    IF(IGRADE .NE. 0) THEN
      RX = GRADE_TABLE(ISPD, ITYPE)
      MAX_ACCEL = MAX_ACCEL - RX * IGRADE * 100
    ENDIF
    END FUNCTION
      
  ! ==================================================================================================
    REAL FUNCTION MAX_DECEL(NTYPE, RSPD, IGRADE)
    IMPLICIT NONE
    INTEGER, INTENT(IN) :: NTYPE
    REAL, INTENT(IN) :: RSPD, IGRADE
    INTEGER :: ITYPE, ISPD
    REAL :: RX
  ! ----------------------------------------------------------------------
    if(ntype .eq. 12) then
      max_decel = -10
      return
    endif
    ISPD = INT(RSPD)
    ISPD = MIN(ISPD, 110)
    ITYPE = NTYPE
    IF(ITYPE .EQ. 8 .OR. ITYPE .EQ. 9) ITYPE = ITYPE - 7
    IF(ITYPE .EQ. 10 .OR. ITYPE .EQ. 11) ITYPE = 1
    MAX_DECEL = DECEL_TABLE(ISPD, ITYPE)
 
  ! --- Adjust the max deceleration for grade if necessary.
 
    IF(IGRADE .NE. 0) THEN
      RX = GRADE_TABLE(ISPD, ITYPE)
      MAX_DECEL = MAX_DECEL - RX * IGRADE * 100
    ENDIF
    END FUNCTION
      
  END MODULE